# 美容室予約システム 操作・運用マニュアル

## 📚 目次
1. [システム概要](#システム概要)
2. [環境要件](#環境要件)
3. [システム起動手順](#システム起動手順)
4. [基本操作ガイド](#基本操作ガイド)
5. [管理者操作](#管理者操作)
6. [トラブルシューティング](#トラブルシューティング)
7. [よくある質問](#よくある質問)

---

## システム概要

### 🎯 システムの目的
- 美容室の予約管理をデジタル化
- Googleカレンダー風の直感的なUI
- リアルタイム予約管理
- マルチテナント対応（複数店舗対応）

### 🏗️ 技術構成
- **フロントエンド**: Nuxt 3 + Vue 3 + TypeScript
- **バックエンド**: Firebase (Firestore + Auth + Functions)
- **デザインシステム**: Bootstrap 5 + カスタムCSS
- **国際化**: @nuxtjs/i18n (日本語対応)

---

## 環境要件

### 💻 システム要件
- Node.js 18.0.0以上
- npm 8.0.0以上
- Docker & Docker Compose
- モダンブラウザ（Chrome, Firefox, Safari, Edge）

### 🌐 ネットワーク要件
- インターネット接続（Firebase接続用）
- ポート3000（フロントエンド）
- ポート4000（Firebase Emulator UI）

---

## システム起動手順

### 🚀 クイックスタート

#### 1. プロジェクトの準備
```bash
# プロジェクトのクローン（初回のみ）
git clone [repository-url]
cd haircut-reservation

# 依存関係のインストール
npm install
```

#### 2. 環境別起動方法

##### ローカル環境（Firebase Emulator使用）
```bash
# 一発起動
npm run dev

# または個別起動
npm run dev:fresh  # キャッシュクリア後起動
```

##### リモート開発環境
```bash
npm run dev:remote
```

##### 本番環境
```bash
npm run prod
```

#### 3. 起動確認
- フロントエンド: http://localhost:3000
- Firebase Emulator UI: http://localhost:4000 (ローカル環境のみ)

### 🔧 システム停止
```bash
npm run dev:down
```

---

## 基本操作ガイド

### 🔐 ログイン・認証

#### 初回アクセス
1. ブラウザで `http://localhost:3000` にアクセス
2. 未ログイン状態では自動的にログインページにリダイレクト
3. 以下の方法でログイン：
   - メールアドレス・パスワード
   - Googleアカウント（ソーシャルログイン）

#### テスト用アカウント（ローカル環境）
- Firebase Emulatorを使用しているため、任意のメールアドレスでアカウント作成可能
- パスワードは6文字以上で設定

### 📅 予約管理画面（メイン機能）

#### カレンダー表示の切り替え
1. **月表示（デフォルト）**
   - 月全体の予約状況を俯瞰
   - 予約がある日にはドット表示
   
2. **週表示**
   - 1週間の詳細スケジュール
   - 時間軸でタイムライン表示
   
3. **日表示**
   - 1日の詳細スケジュール
   - 時間別の空き状況確認

#### 予約の作成
1. カレンダー上の日付をクリック
2. 「予約を追加」ボタンをクリック
3. 必要情報を入力：
   - お客様名
   - 電話番号
   - メールアドレス
   - サービス内容
   - 担当スタッフ
   - 開始時間・終了時間
   - 備考

#### 予約の編集・削除
1. カレンダー上の既存予約をクリック
2. 予約詳細モーダルが表示
3. 「編集」または「削除」ボタンで操作

### 📊 ダッシュボード機能

#### 統計情報の確認
- **今日の予約数**: 当日の予約件数
- **今週の予約数**: 今週の予約件数
- **今日の売上**: 完了した予約の売上合計
- **稼働率**: 営業時間に対する予約率

#### クイックアクション
- **新規予約**: 素早く予約作成
- **飛び込み予約**: 当日の緊急予約対応
- **今日の予定**: 当日スケジュール確認
- **売上レポート**: 売上分析画面へ遷移

---

## 管理者操作

### 🔧 システム設定

#### Firebase環境の切り替え
1. 管理者メニューから「設定」
2. 「Firebase環境設定」
3. 環境選択（Local/Development/Production）
4. 設定保存後、ブラウザリフレッシュ

#### メール通知設定
1. 管理者メニューから「メール設定」
2. 各種設定の変更：
   - 確認メール送信の有効/無効
   - リマインダー送信の有効/無効
   - リマインダー送信時間（24時間前など）
   - メールテンプレートの設定

### 👥 ユーザー管理

#### 権限レベル
- **super_admin**: システム全体の管理
- **tenant_owner**: 事業者オーナー（全権限）
- **staff**: スタッフ（限定的権限）
- **customer**: 顧客（読み取り・予約作成のみ）

#### スタッフ管理
1. 管理者メニューから「スタッフ管理」
2. 新規スタッフ追加・編集・削除
3. 権限設定・専門分野設定

---

## トラブルシューティング

### 🚨 よくある問題と解決方法

#### システムが起動しない
```bash
# Docker環境の確認
docker --version
docker compose --version

# コンテナの状況確認
npm run status

# 強制的な再起動
npm run dev:fresh
```

#### ページが表示されない（白い画面）
1. ブラウザのコンソールエラーを確認
2. Firebase接続状況を確認
3. ページのハードリフレッシュ（Ctrl+Shift+R または Cmd+Shift+R）
4. ブラウザキャッシュクリア

#### Firebase接続エラー
```bash
# Firebase接続テスト
npm run test:firebase:local

# 環境変数の確認
cat .env.local

# Emulator再起動（ローカル環境）
npm run dev:down
npm run dev
```

#### カレンダーが表示されない
1. 認証状況の確認（ログイン済みか）
2. Firebase Firestore接続の確認
3. ブラウザの開発者ツールでエラー確認
4. 以下のコマンドでシステム状況確認：
```bash
npm run health:local
```

#### 認証が機能しない
1. Firebase Auth設定の確認
2. 環境変数の確認（FIREBASE_API_KEY等）
3. ブラウザのサードパーティCookie設定確認
4. シークレットモードでの動作確認

### 🔍 デバッグ方法

#### ログの確認
```bash
# フロントエンドログ
npm run logs:frontend

# Firebase Emulatorログ
npm run logs:firebase

# 全体ログ
npm run logs
```

#### 開発者ツールの活用
1. ブラウザの開発者ツールを開く（F12）
2. **Console**: エラーメッセージの確認
3. **Network**: API通信の確認
4. **Application**: LocalStorage、SessionStorage確認

---

## よくある質問

### ❓ FAQ

#### Q: ログインしているのにログインページにリダイレクトされる
A: 
1. ブラウザのCookieが有効になっているか確認
2. セッションの有効期限切れの可能性
3. 一度ログアウトして再ログイン

#### Q: 予約データが表示されない
A:
1. Firebase Firestoreのアクセス権限確認
2. 日付範囲の確認（過去のデータは表示されない設定の場合）
3. フィルター設定の確認

#### Q: システムの動作が重い
A:
1. ブラウザのタブ数を減らす
2. ブラウザキャッシュをクリア
3. 大量データの場合は表示期間を短縮

#### Q: スマートフォンで正しく表示されない
A:
1. レスポンシブデザイン対応済み
2. ブラウザの最新版使用推奨
3. 横向き表示も試してください

#### Q: データのバックアップ方法
A:
1. Firebase Firestoreのエクスポート機能使用
2. 管理者権限で定期的なバックアップ推奨
3. 詳細は管理者マニュアル参照

### 📞 サポート連絡先

#### 技術サポート
- システム障害: 緊急連絡先
- 操作方法: ヘルプデスク
- 機能追加要望: 開発チーム

#### システム管理者情報
- 管理者アカウント管理
- 権限設定変更
- システム設定変更

---

## 📝 更新履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0.0 | 2025-01-31 | 初版リリース |
| 1.0.1 | 2025-01-31 | 日本語化対応 |
| 1.0.2 | 2025-01-31 | カレンダー表示改善 |

---

**📧 このマニュアルに関するご質問・改善提案は、システム管理者までご連絡ください。**